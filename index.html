<!DOCTYPE html>
<html>
<head>
    <title>NyxOraculum</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #0a0a1a;
            --text-color: #e6e6fa;
            --accent: #4b0082;
            --particle: #9370db;
        }

        body {
            background: var(--bg-color);
            color: var(--text-color);
            font-family: 'MedievalSharp', cursive;
            margin: 0;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            position: relative;
        }

        /* –°—Ç–∏–ª–∏ –∫–Ω–æ–ø–æ–∫ –∏ –∞–Ω–∏–º–∞—Ü–∏–π */
        .game-btn {
            background: linear-gradient(45deg, #2b1055, #4b0082);
            border: 2px solid #7b68ee;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 15px;
            color: white;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, filter 0.3s;
            font-family: inherit;
            font-size: 1.1em;
            box-shadow: 0 4px 15px rgba(75,0,130,0.3);
        }

        .game-btn:active {
            transform: scale(0.95);
            transition: transform 0.1s;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è —á–∞—Å—Ç–∏—Ü */
        .particle {
            position: absolute;
            pointer-events: none;
            background: radial-gradient(circle at center, 
                rgba(255,255,255,0.8) 0%, 
                rgba(148,87,235,0.8) 50%, 
                rgba(75,0,130,0.8) 100%);
            border-radius: 50%;
            animation: nox-explode 1s ease-out forwards;
            mix-blend-mode: screen;
            filter: brightness(1.2);
        }

        @keyframes nox-explode {
            0% {
                transform: translate(-50%, -50%) scale(0.5) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translate(calc(-50% + var(--tx, 0)), calc(-50% + var(--ty, 0))) scale(2.5) rotate(360deg);
                opacity: 0;
            }
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ */
        #menu, #game-container {
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        .menu-hidden {
            opacity: 0 !important;
            transform: translateY(-20px) scale(0.95);
            pointer-events: none;
        }

        .game-enter {
            animation: gameEnter 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes gameEnter {
            0% { opacity: 0; transform: translateY(50px) rotateX(-30deg); }
            100% { opacity: 1; transform: translateY(0) rotateX(0); }
        }

        .magic-fog {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, 
                rgba(75,0,130,0.4) 0%, 
                rgba(75,0,130,0) 70%);
            pointer-events: none;
            animation: fogSpread 0.8s ease-out;
            z-index: 999;
        }

        @keyframes fogSpread {
            0% { opacity: 0; transform: scale(0.5); }
            50% { opacity: 1; transform: scale(1.2); }
            100% { opacity: 0; transform: scale(1.5); }
        }

        /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        .stats {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border-radius: 10px;
            backdrop-filter: blur(5px);
            z-index: 1000;
        }

        .back-btn {
            position: fixed;
            top: 10px;
            left: 10px;
            z-index: 1000;
        }

        .game-container {
            margin-top: 30px;
            padding: 20px;
            border: 2px solid #4b0082;
            border-radius: 15px;
            background: rgba(0,0,0,0.3);
            min-height: 300px;
            opacity: 0;
            transform: translateY(20px);
        }

        .zener-card {
            width: 100px;
            height: 150px;
            margin: 10px;
            border: 2px solid #7b68ee;
            border-radius: 10px;
            cursor: pointer;
            background: rgba(255,255,255,0.1);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            transition: transform 0.3s;
        }

        .color-option {
            width: 80px;
            height: 80px;
            margin: 10px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            transition: transform 0.3s;
        }

        .psi-target {
            width: 100px;
            height: 100px;
            background: #ff4444;
            border-radius: 50%;
            margin: 20px auto;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.5s, transform 0.3s;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="stats" id="stats"></div>
        <button class="game-btn back-btn" onclick="showMenu()" style="display: none;">‚Üê –ù–∞–∑–∞–¥</button>
        <h1>üîÆ NyxOraculum</h1>
        
        <div id="menu">
            <button class="game-btn" data-game="numerical">üî¢ –ß–∏—Å–ª–æ–≤–∞—è –º–∞–≥–∏—è</button>
            <button class="game-btn" data-game="zener">üÉè –ö–∞—Ä—Ç—ã –ó–µ–Ω–µ—Ä–∞</button>
            <button class="game-btn" data-game="color">üé® –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω—Ç—É–∏—Ü–∏—è</button>
            <button class="game-btn" data-game="psi">üåÄ –ü—Å–∏-–∫–æ–Ω—Ç—Ä–æ–ª—å</button>
            <button class="game-btn" onclick="clearStats()">‚ùå –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
        </div>

        <div id="game-container" class="game-container"></div>
    </div>

    <script>
        const ZENER_SYMBOLS = ['‚óã', '+', '‚âà', '‚ñ°', '‚òÖ'];
        const COLORS = ['#FF0000', '#00FF00', '#0000FF', '#FFFF00', '#FF00FF'];
        
        let currentGame = {};
        let stats = JSON.parse(localStorage.getItem('nyx_stats') || '{}');
        let psiStartTime;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            showStats();
            setupEventListeners();
        }

        function setupEventListeners() {
            document.querySelectorAll('.game-btn').forEach(btn => {
                btn.addEventListener('click', async (e) => {
                    if(btn.dataset.game) {
                        await loadGame(btn.dataset.game);
                    }
                    createParticles(e.target);
                });
            });

            document.addEventListener('click', (e) => {
                if(e.target.classList.contains('game-btn')) {
                    createParticles(e.target);
                }
            });
        }

        // –ê–Ω–∏–º–∞—Ü–∏—è —á–∞—Å—Ç–∏—Ü
        function createParticles(element, count = 15) {
            const rect = element.getBoundingClientRect();
            const centerX = rect.left + rect.width/2;
            const centerY = rect.top + rect.height/2;
            
            for(let i = 0; i < count; i++) {
                const angle = (Math.PI * 2 * i) / count;
                const velocity = 1 + Math.random() * 3;
                const tx = Math.cos(angle) * 100 * velocity;
                const ty = Math.sin(angle) * 100 * velocity;
                
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                particle.style.cssText = `
                    left: ${centerX}px;
                    top: ${centerY}px;
                    width: ${5 + Math.random() * 10}px;
                    height: ${5 + Math.random() * 10}px;
                    --tx: ${tx}px;
                    --ty: ${ty}px;
                    animation-duration: ${0.6 + Math.random() * 0.4}s;
                    filter: hue-rotate(${Math.random() * 360}deg);
                `;

                document.body.appendChild(particle);
                
                particle.addEventListener('animationend', () => {
                    particle.remove();
                });
            }
        }

        // –ê–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
        async function loadGame(game) {
            const menu = document.getElementById('menu');
            const container = document.getElementById('game-container');
            
            menu.classList.add('menu-hidden');
            createFogEffect();
            
            await new Promise(resolve => setTimeout(resolve, 300));
            
            container.style.display = 'block';
            container.innerHTML = getGameHTML(game);
            container.classList.add('game-enter');
            container.style.opacity = '1';
            container.style.transform = 'translateY(0)';
            
            document.querySelector('.back-btn').style.display = 'block';
            
            if(game === 'psi') {
                document.getElementById('psi-target').addEventListener('click', psiClick);
            }
        }

        async function showMenu() {
            const menu = document.getElementById('menu');
            const container = document.getElementById('game-container');
            
            container.classList.remove('game-enter');
            container.style.opacity = '0';
            container.style.transform = 'translateY(20px)';
            createFogEffect();
            
            await new Promise(resolve => setTimeout(resolve, 300));
            
            container.style.display = 'none';
            menu.classList.remove('menu-hidden');
            document.querySelector('.back-btn').style.display = 'none';
        }

        function createFogEffect() {
            const fog = document.createElement('div');
            fog.className = 'magic-fog';
            document.body.appendChild(fog);
            setTimeout(() => fog.remove(), 800);
        }

        // –ò–≥—Ä—ã
        function getGameHTML(game) {
            return {
                numerical: numericalMagic(),
                zener: zenerCards(),
                color: colorIntuition(),
                psi: psiControl()
            }[game];
        }

        function numericalMagic() {
            return `
                <h3>üî¢ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 10</h3>
                <input type="number" id="guess" min="1" max="10">
                <button class="game-btn" onclick="checkNumber()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                <p id="numerical-result"></p>
            `;
        }

        function zenerCards() {
            currentGame.target = ZENER_SYMBOLS[Math.floor(Math.random()*5)];
            return `
                <h3>üÉè –í—ã–±–µ—Ä–∏ —É–≤–∏–¥–µ–Ω–Ω—É—é –∫–∞—Ä—Ç—É</h3>
                <div>${ZENER_SYMBOLS.map(s => `
                    <div class="zener-card" onclick="checkZener('${s}')">${s}</div>
                `).join('')}</div>
                <p id="zener-result"></p>
            `;
        }

        function colorIntuition() {
            currentGame.target = COLORS[Math.floor(Math.random()*5)];
            return `
                <h3>üé® –í—ã–±–µ—Ä–∏ –∑–∞–≥–∞–¥–∞–Ω–Ω—ã–π —Ü–≤–µ—Ç</h3>
                <div>${COLORS.map(c => `
                    <div class="color-option" style="background:${c}" onclick="checkColor('${c}')"></div>
                `).join('')}</div>
                <p id="color-result"></p>
            `;
        }

        function psiControl() {
            return `
                <h3>üåÄ –ù–∞–∂–º–∏ –∫–æ–≥–¥–∞ —Å–≤–µ—á–µ–Ω–∏–µ —Å—Ç–∞–Ω–µ—Ç –∫—Ä–∞—Å–Ω—ã–º</h3>
                <div class="psi-target" id="psi-target"></div>
                <p id="psi-result"></p>
                <button class="game-btn" onclick="startPsiTest()">–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç</button>
            `;
        }

        // –õ–æ–≥–∏–∫–∞ –∏–≥—Ä
        function checkNumber() {
            const guess = parseInt(document.getElementById('guess').value);
            const correct = Math.ceil(Math.random()*10);
            const result = guess === correct;
            document.getElementById('numerical-result').innerHTML = result ? 
                'üéØ –í–µ—Ä–Ω–æ! –¢—ã –≤–∏–¥–∏—à—å —Å–∫–≤–æ–∑—å –≤—Ä–µ–º—è!' : 
                `‚ùå –ù–µ–≤–µ—Ä–Ω–æ! –Ø –∑–∞–≥–∞–¥–∞–ª ${correct}`;
            updateStats('numerical', result);
        }

        function checkZener(symbol) {
            const result = symbol === currentGame.target;
            document.getElementById('zener-result').innerHTML = result ?
                'üîÆ –í–µ—Ä–Ω–æ! –¢–≤–æ–π —Ç—Ä–µ—Ç–∏–π –≥–ª–∞–∑ –æ—Ç–∫—Ä—ã—Ç!' :
                'üëÅÔ∏è –ù–µ–≤–µ—Ä–Ω–æ! –°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Å—è —Å–∏–ª—å–Ω–µ–µ...';
            updateStats('zener', result);
        }

        function checkColor(color) {
            const result = color === currentGame.target;
            document.getElementById('color-result').innerHTML = result ?
                'üåà –í–µ—Ä–Ω–æ! –¢—ã —á—É–≤—Å—Ç–≤—É–µ—à—å —ç–Ω–µ—Ä–≥–∏–∏!' :
                'üé® –ù–µ–≤–µ—Ä–Ω–æ! –ù–∞—Å—Ç—Ä–æ–π —Å–≤–æ—é –∞—É—Ä—É...';
            updateStats('color', result);
        }

        function startPsiTest() {
            const target = document.getElementById('psi-target');
            target.style.opacity = '0';
            setTimeout(() => {
                target.style.opacity = '1';
                psiStartTime = Date.now();
            }, Math.random()*3000 + 1000);
        }

        function psiClick() {
            if(!psiStartTime) return;
            const reactionTime = Date.now() - psiStartTime;
            const result = reactionTime < 500;
            document.getElementById('psi-result').innerHTML = result ?
                `‚ö° –ú–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω–æ! ${reactionTime}ms` :
                `üê¢ –°–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ! ${reactionTime}ms`;
            updateStats('psi', result);
            psiStartTime = null;
        }

        // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        function updateStats(game, result) {
            if(!stats[game]) stats[game] = { attempts: 0, correct: 0 };
            stats[game].attempts++;
            if(result) stats[game].correct++;
            localStorage.setItem('nyx_stats', JSON.stringify(stats));
            showStats();
        }

        function showStats() {
            const statsDiv = document.getElementById('stats');
            statsDiv.innerHTML = '<h4>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</h4>' + 
                Object.entries(stats).map(([game, data]) => `
                    <div>${gameIcon(game)} ${data.correct}/${data.attempts} 
                    (${Math.round(data.correct/data.attempts*100 || 0}%)</div>
                `).join('');
        }

        function gameIcon(game) {
            return {
                numerical: 'üî¢',
                zener: 'üÉè',
                color: 'üé®',
                psi: 'üåÄ'
            }[game];
        }

        function clearStats() {
            if(confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É?')) {
                localStorage.removeItem('nyx_stats');
                stats = {};
                showStats();
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        init();
        document.addEventListener('DOMContentLoaded', () => {
            try {
                Telegram.WebApp.ready();
                Telegram.WebApp.expand();
            } catch(e) {
                // –†–∞–±–æ—Ç–∞ –≤–Ω–µ Telegram
            }
        });
    </script>
</body>
</html>