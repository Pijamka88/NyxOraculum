<!DOCTYPE html>
<html>
<head>
    <title>NyxOraculum</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        :root {
            --bg-color: #0a0a1a;
            --text-color: #e6e6fa;
            --accent: #4b0082;
            --button-size: 4rem;
        }

        body {
            background: linear-gradient(-45deg, #0a0a1a, #2b1055, #4b0082, #7b68ee);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: var(--text-color);
            margin: 0;
            padding: 10px;
            overflow-x: hidden;
            min-height: 100vh;
            font-size: 20px;
            touch-action: manipulation;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 10px;
            display: flex;
            flex-direction: column;
            height: calc(100vh - 20px);
        }

        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin: 20px 0;
        }

        .game-btn {
            background: rgba(75, 0, 130, 0.7);
            border: 2px solid #7b68ee;
            padding: 15px;
            margin: 8px;
            border-radius: 15px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            backdrop-filter: blur(5px);
            font-size: 1.8rem;
            min-width: var(--button-size);
            min-height: var(--button-size);
            display: flex;
            align-items: center;
            justify-content: center;
            -webkit-tap-highlight-color: transparent;
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            padding: 15px;
        }

        .game-container {
            margin-top: 20px;
            padding: 15px;
            border: 2px solid #4b0082;
            border-radius: 15px;
            background: rgba(0,0,0,0.3);
            display: none;
            position: relative;
            backdrop-filter: blur(5px);
            flex-grow: 1;
            overflow: auto;
        }

        .stats {
            background: rgba(0,0,0,0.5);
            padding: 15px;
            border-radius: 15px;
            margin-top: 20px;
            font-size: 1.2rem;
        }

        /* –ß–∏—Å–ª–æ–≤–∞—è –º–∞–≥–∏—è */
        .number-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            padding: 10px;
        }

        /* –ö–∞—Ä—Ç—ã –ó–µ–Ω–µ—Ä–∞ */
        .zener-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            padding: 10px;
        }

        .zener-btn {
            font-size: 3rem;
            padding: 20px;
        }

        /* –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω—Ç—É–∏—Ü–∏—è */
        .color-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            padding: 15px;
        }

        .color-btn {
            width: 100%;
            height: 100px;
            border-radius: 15px;
            border: 3px solid transparent;
        }

        /* –ü—Å–∏-–∫–æ–Ω—Ç—Ä–æ–ª—å */
        .psi-area {
            position: relative;
            width: 100%;
            height: 300px;
            margin: 20px 0;
        }

        .psi-circle {
            width: 70px;
            height: 70px;
            background: #ff4444;
            border-radius: 50%;
            position: absolute;
            transition: transform 0.1s;
            box-shadow: 0 0 15px #ff4444;
            touch-action: none;
        }

        .psi-target {
            width: 120px;
            height: 120px;
            border: 3px solid #7b68ee;
            border-radius: 50%;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 15px #7b68ee;
        }

        .result-text {
            text-align: center;
            font-size: 1.5rem;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <button class="game-btn back-btn" onclick="showMenu()" style="display: none;">‚Üê</button>
        <h1>üîÆ NyxOraculum</h1>
        
        <div id="menu">
            <div class="menu-grid">
                <button class="game-btn" data-game="numerical">üî¢<br><span style="font-size: 1rem">–ß–∏—Å–ª–∞</span></button>
                <button class="game-btn" data-game="zener">üÉè<br><span style="font-size: 1rem">–ö–∞—Ä—Ç—ã</span></button>
                <button class="game-btn" data-game="color">üé®<br><span style="font-size: 1rem">–¶–≤–µ—Ç–∞</span></button>
                <button class="game-btn" data-game="psi">üåÄ<br><span style="font-size: 1rem">–ö–æ–Ω—Ç—Ä–æ–ª—å</span></button>
            </div>
        </div>

        <div id="game-container" class="game-container"></div>
    </div>

    <script>
        const ZENER_SYMBOLS = ['‚óã', '+', '‚âà', '‚ñ°', '‚òÖ'];
        const COLORS = ['#FF0000', '#00FF00', '#0000FF', '#FFFF00', '#FF00FF'];
        
        let stats = JSON.parse(localStorage.getItem('nyx_stats')) || {
            numerical: { attempts: 0, correct: 0 },
            zener: { attempts: 0, correct: 0 },
            color: { attempts: 0, correct: 0 },
            psi: { attempts: 0, successTime: 0 }
        };

        let currentGame = {
            target: null,
            psi: {
                circle: null,
                target: null,
                isDragging: false,
                startTime: null,
                totalSuccess: 0,
                touchId: null,
                timer: null
            }
        };

        function init() {
            setupEventListeners();
        }

        function setupEventListeners() {
            document.querySelectorAll('.game-btn[data-game]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const game = e.target.closest('button').dataset.game;
                    loadGame(game);
                });
            });
        }

        function loadGame(game) {
            const menu = document.getElementById('menu');
            const container = document.getElementById('game-container');
            
            menu.style.display = 'none';
            document.querySelector('.back-btn').style.display = 'block';
            container.style.display = 'flex';
            container.style.flexDirection = 'column';
            container.innerHTML = '';

            switch(game) {
                case 'numerical':
                    initNumerical(container);
                    break;
                case 'zener':
                    initZener(container);
                    break;
                case 'color':
                    initColor(container);
                    break;
                case 'psi':
                    initPsi(container);
                    break;
            }

            updateStats(container, game);
        }

        function initNumerical(container) {
            currentGame.target = Math.floor(Math.random() * 10) + 1;
            
            const numbers = Array.from({length: 10}, (_, i) => i + 1)
                .sort(() => Math.random() - 0.5);

            container.innerHTML = `
                <h3>üî¢ –í—ã–±–µ—Ä–∏ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 10</h3>
                <div class="number-grid">
                    ${numbers.map(num => `
                        <button class="game-btn" onclick="checkNumber(${num})">${num}</button>
                    `).join('')}
                </div>
                <p class="result-text" id="numerical-result"></p>
                <div class="stats"></div>
            `;
        }

        function initZener(container) {
            currentGame.target = ZENER_SYMBOLS[Math.floor(Math.random() * 5)];
            
            container.innerHTML = `
                <h3>üÉè –í—ã–±–µ—Ä–∏ —É–≤–∏–¥–µ–Ω–Ω—É—é –∫–∞—Ä—Ç—É</h3>
                <div class="zener-grid">
                    ${ZENER_SYMBOLS.map(s => `
                        <button class="game-btn zener-btn" onclick="checkZener('${s}')">${s}</button>
                    `).join('')}
                </div>
                <p class="result-text" id="zener-result"></p>
                <div class="stats"></div>
            `;
        }

        function initColor(container) {
            currentGame.target = COLORS[Math.floor(Math.random() * 5)];
            
            container.innerHTML = `
                <h3>üé® –í—ã–±–µ—Ä–∏ –∑–∞–≥–∞–¥–∞–Ω–Ω—ã–π —Ü–≤–µ—Ç</h3>
                <div class="color-grid">
                    ${COLORS.map(c => `
                        <button 
                            class="color-btn" 
                            style="background:${c}" 
                            onclick="checkColor('${c}')"
                        ></button>
                    `).join('')}
                </div>
                <p class="result-text" id="color-result"></p>
                <div class="stats"></div>
            `;
        }

        function initPsi(container) {
            container.innerHTML = `
                <h3>üåÄ –£–ø—Ä–∞–≤–ª—è–π —à–∞—Ä–æ–º —Å–∏–ª–æ–π –º—ã—Å–ª–∏!</h3>
                <div class="psi-area">
                    <div class="psi-target"></div>
                </div>
                <p class="result-text" id="psi-result">–£–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ —à–∞—Ä –≤ –∫—Ä—É–≥–µ</p>
                <div class="stats"></div>
            `;

            const psiArea = container.querySelector('.psi-area');
            currentGame.psi.circle = document.createElement('div');
            currentGame.psi.circle.className = 'psi-circle';
            psiArea.appendChild(currentGame.psi.circle);

            // Touch events
            psiArea.addEventListener('touchstart', handleTouchStart, {passive: false});
            psiArea.addEventListener('touchmove', handleTouchMove, {passive: false});
            psiArea.addEventListener('touchend', handleTouchEnd);

            // Mouse events
            psiArea.addEventListener('mousedown', handleMouseDown);
            document.addEventListener('mousemove', handleMouseMove);
            document.addEventListener('mouseup', handleMouseUp);
        }

        // Touch handlers
        function handleTouchStart(e) {
            if(currentGame.psi.touchId === null) {
                const touch = e.changedTouches[0];
                currentGame.psi.touchId = touch.identifier;
                startPsiDrag(touch.clientX, touch.clientY);
                e.preventDefault();
            }
        }

        function handleTouchMove(e) {
            Array.from(e.changedTouches).forEach(touch => {
                if(touch.identifier === currentGame.psi.touchId) {
                    updatePsiPosition(touch.clientX, touch.clientY);
                    e.preventDefault();
                }
            });
        }

        function handleTouchEnd(e) {
            Array.from(e.changedTouches).forEach(touch => {
                if(touch.identifier === currentGame.psi.touchId) {
                    endPsiDrag();
                    currentGame.psi.touchId = null;
                }
            });
        }

        // Mouse handlers
        function handleMouseDown(e) {
            startPsiDrag(e.clientX, e.clientY);
        }

        function handleMouseMove(e) {
            if(currentGame.psi.isDragging) {
                updatePsiPosition(e.clientX, e.clientY);
            }
        }

        function handleMouseUp() {
            endPsiDrag();
        }

        function startPsiDrag(x, y) {
            currentGame.psi.isDragging = true;
            currentGame.psi.startTime = Date.now();
            currentGame.psi.totalSuccess = 0;
            updatePsiPosition(x, y);
            
            // Start timer
            currentGame.psi.timer = setInterval(() => {
                if(currentGame.psi.isDragging) {
                    stats.psi.successTime += 1;
                    saveStats();
                    updateStats(document.getElementById('game-container'), 'psi');
                }
            }, 1000);
        }

        function updatePsiPosition(x, y) {
            if(!currentGame.psi.isDragging) return;
            
            const rect = currentGame.psi.circle.parentElement.getBoundingClientRect();
            const circleSize = currentGame.psi.circle.offsetWidth;
            
            const posX = x - rect.left - circleSize/2;
            const posY = y - rect.top - circleSize/2;
            
            const maxX = rect.width - circleSize;
            const maxY = rect.height - circleSize;
            
            currentGame.psi.circle.style.left = `${Math.max(0, Math.min(posX, maxX))}px`;
            currentGame.psi.circle.style.top = `${Math.max(0, Math.min(posY, maxY))}px`;
            
            checkPsiCollision();
        }

        function checkPsiCollision() {
            const circleRect = currentGame.psi.circle.getBoundingClientRect();
            const targetRect = currentGame.psi.target.getBoundingClientRect();
            
            if(checkCollision(circleRect, targetRect)) {
                currentGame.psi.totalSuccess += 100;
                document.getElementById('psi-result').textContent = 'üåÄ –£–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ!';
            } else {
                document.getElementById('psi-result').textContent = 'üåÄ –í–µ—Ä–Ω–∏—Ç–µ —à–∞—Ä –≤ –∫—Ä—É–≥!';
            }
        }

        function checkCollision(rect1, rect2) {
            return !(rect1.right < rect2.left || 
                    rect1.left > rect2.right || 
                    rect1.bottom < rect2.top || 
                    rect1.top > rect2.bottom);
        }

        function endPsiDrag() {
            if(!currentGame.psi.isDragging) return;
            
            currentGame.psi.isDragging = false;
            stats.psi.attempts++;
            saveStats();
            updateStats(document.getElementById('game-container'), 'psi');
            
            clearInterval(currentGame.psi.timer);
            currentGame.psi.timer = null;
        }

        function checkNumber(selected) {
            const result = selected === currentGame.target;
            
            stats.numerical.attempts++;
            if(result) stats.numerical.correct++;
            saveStats();
            
            const resultElement = document.getElementById('numerical-result');
            resultElement.textContent = result ? 'üéØ –í–µ—Ä–Ω–æ!' : '‚ùå –ù–µ–≤–µ—Ä–Ω–æ!';
            resultElement.style.color = result ? '#7b68ee' : '#ff4444';
            
            initNumerical(document.getElementById('game-container'));
        }

        function checkZener(symbol) {
            const result = symbol === currentGame.target;
            
            stats.zener.attempts++;
            if(result) stats.zener.correct++;
            saveStats();
            
            const resultElement = document.getElementById('zener-result');
            resultElement.textContent = result ? 'üîÆ –í–µ—Ä–Ω–æ!' : '‚ùå –ù–µ–≤–µ—Ä–Ω–æ!';
            resultElement.style.color = result ? '#7b68ee' : '#ff4444';
            
            initZener(document.getElementById('game-container'));
        }

        function checkColor(color) {
            const result = color === currentGame.target;
            
            stats.color.attempts++;
            if(result) stats.color.correct++;
            saveStats();
            
            const resultElement = document.getElementById('color-result');
            resultElement.textContent = result ? 'üåà –í–µ—Ä–Ω–æ!' : '‚ùå –ù–µ–≤–µ—Ä–Ω–æ!';
            resultElement.style.color = result ? '#7b68ee' : '#ff4444';
            
            initColor(document.getElementById('game-container'));
        }

        function updateStats(container, game) {
            const statsHTML = {
                numerical: `–ü–æ–ø—ã—Ç–∫–∏: ${stats.numerical.attempts}<br>–£–≥–∞–¥–∞–Ω–æ: ${stats.numerical.correct}`,
                zener: `–ü–æ–ø—ã—Ç–∫–∏: ${stats.zener.attempts}<br>–£–≥–∞–¥–∞–Ω–æ: ${stats.zener.correct}`,
                color: `–ü–æ–ø—ã—Ç–∫–∏: ${stats.color.attempts}<br>–£–≥–∞–¥–∞–Ω–æ: ${stats.color.correct}`,
                psi: `–ü–æ–ø—ã—Ç–∫–∏: ${stats.psi.attempts}<br>–í—Ä–µ–º—è: ${stats.psi.successTime} —Å–µ–∫`
            };
            
            container.querySelector('.stats').innerHTML = statsHTML[game];
        }

        function saveStats() {
            localStorage.setItem('nyx_stats', JSON.stringify(stats));
        }

        function showMenu() {
            document.getElementById('menu').style.display = 'block';
            document.querySelector('.back-btn').style.display = 'none';
            document.getElementById('game-container').style.display = 'none';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        init();
    </script>
</body>
</html>